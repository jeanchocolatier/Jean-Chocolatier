<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contrôle - Jean Chocolatier</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<header>
    <div class="header-content">
        <span class="brand-name">Panneau de Contrôle</span>
        <button onclick="logout()" class="logout-btn">Déconnexion</button>
    </div>
</header>

<main class="control-main">
    <h1>Données enregistrées</h1>

    <h2>Commandes</h2>
    <button onclick="clearOrders()" class="clear-btn">Effacer historique commandes</button>
    <table id="ordersTable">
        <thead>
            <tr>
                <th>Nom</th><th>Email</th><th>Adresse</th><th>Panier</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <h2>Messages Contact</h2>
    <button onclick="clearMessages()" class="clear-btn">Effacer historique messages</button>
    <table id="messagesTable">
        <thead>
            <tr>
                <th>Nom</th><th>Email</th><th>Sujet</th><th>Message</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

</main>

<script>
if (localStorage.getItem("adminLogged") !== "true") {
    window.location.href = "login.html";
}

// Charger les commandes
const orders = JSON.parse(localStorage.getItem("orders") || "[]");
const tbodyOrders = document.querySelector("#ordersTable tbody");

orders.forEach(o => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
        <td>${o.firstName} ${o.lastName}</td>
        <td>${o.email}</td>
        <td>${o.address}</td>
        <td>${o.cart}</td>
    `;
    tbodyOrders.appendChild(tr);
});

// Charger les messages
const msgs = JSON.parse(localStorage.getItem("contactMessages") || "[]");
const tbodyMsg = document.querySelector("#messagesTable tbody");

msgs.forEach(m => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
        <td>${m.name}</td>
        <td>${m.email}</td>
        <td>${m.subject}</td>
        <td>${m.message}</td>
    `;
    tbodyMsg.appendChild(tr);
});

function clearOrders() {
    if (confirm("Supprimer toutes les commandes ?")) {
        localStorage.removeItem("orders");
        location.reload();
    }
}

function clearMessages() {
    if (confirm("Supprimer tous les messages ?")) {
        localStorage.removeItem("contactMessages");
        location.reload();
    }
}

function logout() {
    localStorage.removeItem("adminLogged");
    window.location.href = "index.html";
}
</script>

</body>
</html>
